<!-- The following line is essential for the "position: fixed" property to work correctly in IE -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>jquery.ui.chatbox</title>
    <link rel="stylesheet" href="/chatbox/jquery-ui-1.8.2.custom/css/ui-lightness/jquery-ui-1.8.2.custom.css" type="text/css" media="screen" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.js"></script>
    <!--let's add the sources of Programmable Chat and Twilio Common-->

    <link type="text/css" href="jquery.ui.chatbox.css" rel="stylesheet" />
    <script type="text/javascript" src="jquery.ui.chatbox.js"></script>
    <script type="text/javascript">
           
        window.addEventListener("beforeunload", function (e) {
        
            //leaveChannel();

        (e || window.event).returnValue = null;
        return null;
        });

        //leave function
            
        //generate a token 
                                         
            $(document).ready(function(){
                    var box = null;    
                    box = $("#chat_div").chatbox({id:"chat_div", 
                                                user:{key : "value"},
                                                  title : "test chat",
                                                  messageSent : function(id, user, msg) {
                                                      $("#log").append(id + " said: " + msg + "<br/>");
                                                      //send a message with the channel object

                                                    }});
                    //create an event when a message is added to the channel    
                    
                    $("#chat_div").chatbox("option", "boxManager").addMsg(authorName, messageBody);                  
              });

        

</script>
</head>
<body>   
    <button onClick=leaveChannel();>Leave Channel</button>
    <div id="chat_div">
    </div>
    <hr />
    <div id="log">
    </div>
  </body>
</html>
